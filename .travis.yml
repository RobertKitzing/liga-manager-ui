language: node_js

env:
  global:
    - DOCKER_USER=robertkitzing
    - DOCKER_REPO=robertkitzing/liga-manager-ui

services:
  - docker

install:
  - export TAG=`grep '"version":' package.json | cut -d\" -f4`

node_js:
  - "8"

cache:
  directories:
    - node_modules

script:
  - npm run build:web
  - npm run build:app
  - docker build -t $DOCKER_REPO:$TAG-$TRAVIS_BUILD_NUMBER .

after_success:
  - docker login -u $DOCKER_USER -p "$PENIS"
  - docker push $DOCKER_REPO:$TAG-$TRAVIS_BUILD_NUMBER